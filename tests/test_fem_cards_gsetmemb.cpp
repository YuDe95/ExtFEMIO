/**
   \file
   \author Berthold Höllmann <berthold.hoellmann@dnvgl.com>
   \copyright Copyright © 2015 by DNV GL SE
   \brief Testing IO for Sesam FEM `GSETMEMB` cards.

   Detailed description
*/
#include "extfemio_stdafx.h"

#include "extfem_misc.h"

// ID:
namespace {
    const char cID[] _EXTFEMIO_UNUSED =
        "@(#) $Id$";
}

#define NOMINMAX // To avoid problems with "numeric_limits"

#include <vector>

#include <catch.hpp>

#ifdef __GNUC__
#include "config.h"
#endif

#include "fem/cards.h"

#if defined(__AFX_H__) && defined(_DEBUG)
#define new DEBUG_NEW
#undef THIS_FILE
static char THIS_FILE[] = __FILE__;
#endif

using namespace std;

using namespace dnvgl::extfem::fem;
using namespace dnvgl::extfem::fem::cards;

TEST_CASE("FEM GSETMEMB definitions.", "[fem_gsetmemb]") {

    vector<std::string> lines;
    size_t len;

    SECTION("GSETMEMB (1)") {
        vector<std::string> data({
            "GSETMEMB 2.30000000e+001 1.74000000e+002 1.00000000e+000 1.00000000e+000\n",
            "         0.00000000e+000 1.27600000e+004 1.27660000e+004 1.27830000e+004\n",
            "         1.27870000e+004 1.27990000e+004 1.28170000e+004 1.28420000e+004\n",
            "         1.28500000e+004 1.28580000e+004 1.28590000e+004 1.28600000e+004\n",
            "         1.28830000e+004 1.28910000e+004 1.29180000e+004 1.29190000e+004\n",
            "         1.29300000e+004 1.29320000e+004 1.29350000e+004 0.00000000e+000\n"});
        len = __base::card::card_split(data, data.size(), lines);
        gsetmemb probe(lines, len);

        CHECK(probe.NFIELD == 23);
        CHECK(probe.ISREF == 174);
        CHECK(probe.INDEX == 1);
        CHECK(probe.ISTYPE == gsetmemb::types::NODE_SET);
        CHECK(probe.ISORIG == gsetmemb::origins::UNDEF_ORIGIN);
        CHECK(probe.IRMEMB == std::vector<long>({
            12760, 12766, 12783, 12787, 12799, 12817, 12842, 12850,
            12858, 12859, 12860, 12883, 12891, 12918, 12919, 12930,
            12932, 12935}));
    }

    SECTION("GSETMEMB (2)") {
        vector<std::string> data({
            "GSETMEMB 5.00000000e+000 1.74000000e+002 1.00000000e+000 2.00000000e+000\n",
            "         0.00000000e+000 0.00000000e+000 0.00000000e+000 0.00000000e+000\n"});

        len = __base::card::card_split(data, data.size(), lines);
        gsetmemb probe(lines, len);

        CHECK(probe.NFIELD == 5);
        CHECK(probe.ISREF == 174);
        CHECK(probe.INDEX == 1);
        CHECK(probe.ISTYPE == gsetmemb::types::ELEM_SET);
        CHECK(probe.ISORIG == gsetmemb::origins::UNDEF_ORIGIN);
        CHECK(probe.IRMEMB == std::vector<long>({}));
    }


    SECTION("GSETMEMB (2)") {
        vector<std::string> data({
            "GSETMEMB 8.00000000e+000 1.75000000e+002 1.00000000e+000 2.00000000e+000\n",
            "         0.00000000e+000 8.75000000e+002 8.87000000e+002 9.00000000e+002\n"});
        len = __base::card::card_split(data, data.size(), lines);
        gsetmemb probe(lines, len);

        CHECK(probe.NFIELD == 8);
        CHECK(probe.ISREF == 175);
        CHECK(probe.INDEX == 1);
        CHECK(probe.ISTYPE == gsetmemb::types::ELEM_SET);
        CHECK(probe.ISORIG == gsetmemb::origins::UNDEF_ORIGIN);
        CHECK(probe.IRMEMB.size() == 3);
        CHECK(probe.IRMEMB == std::vector<long>({875, 887, 900}));
    }

    SECTION("GSETMEMB (3)") {
        vector<std::string> data({
            "GSETMEMB 1.02400000e+003 1.76000000e+002 1.00000000e+000 2.00000000e+000\n",
            "         0.00000000e+000 6.59770000e+004 6.59780000e+004 6.58070000e+004\n",
            "         6.21740000e+004 6.58080000e+004 6.58090000e+004 5.86830000e+004\n",
            "         6.02940000e+004 6.21750000e+004 6.59790000e+004 6.02950000e+004\n",
            "         6.02960000e+004 6.21760000e+004 6.21770000e+004 6.21780000e+004\n",
            "         6.31600000e+004 6.59800000e+004 6.52380000e+004 6.31610000e+004\n",
            "         6.79170000e+004 6.59810000e+004 6.31620000e+004 6.31630000e+004\n",
            "         6.31640000e+004 5.86840000e+004 6.65570000e+004 6.21790000e+004\n",
            "         6.21800000e+004 6.21810000e+004 6.21820000e+004 6.59820000e+004\n",
            "         6.65580000e+004 6.59830000e+004 6.59840000e+004 6.31660000e+004\n",
            "         6.21830000e+004 6.21840000e+004 6.59850000e+004 6.31670000e+004\n",
            "         6.31680000e+004 6.58100000e+004 6.59860000e+004 6.58110000e+004\n",
            "         6.59870000e+004 6.21850000e+004 5.86850000e+004 6.59880000e+004\n",
            "         6.59890000e+004 3.68980000e+004 6.31690000e+004 6.31700000e+004\n",
            "         5.86860000e+004 6.59900000e+004 6.31720000e+004 6.31730000e+004\n",
            "         6.31740000e+004 6.31750000e+004 6.31760000e+004 6.52390000e+004\n",
            "         6.31770000e+004 6.31780000e+004 6.21860000e+004 6.21870000e+004\n",
            "         6.65590000e+004 6.65600000e+004 6.59910000e+004 6.59920000e+004\n",
            "         6.59930000e+004 6.65610000e+004 6.59940000e+004 6.59950000e+004\n",
            "         6.59960000e+004 6.58120000e+004 6.65620000e+004 6.65630000e+004\n",
            "         6.59970000e+004 6.59980000e+004 5.86870000e+004 6.02970000e+004\n",
            "         6.65640000e+004 6.02980000e+004 6.31790000e+004 6.21880000e+004\n",
            "         6.31800000e+004 6.02990000e+004 6.65650000e+004 6.65660000e+004\n",
            "         6.21890000e+004 6.21900000e+004 6.65670000e+004 6.65680000e+004\n",
            "         6.59990000e+004 6.31810000e+004 6.60000000e+004 6.60010000e+004\n",
            "         6.79180000e+004 6.60020000e+004 6.60030000e+004 6.65690000e+004\n",
            "         6.60040000e+004 6.60050000e+004 6.60060000e+004 6.65700000e+004\n",
            "         6.60070000e+004 6.60080000e+004 6.60090000e+004 6.60100000e+004\n",
            "         6.60110000e+004 6.60120000e+004 6.31820000e+004 6.60130000e+004\n",
            "         6.60140000e+004 5.86880000e+004 6.79190000e+004 6.52400000e+004\n",
            "         6.60150000e+004 6.60160000e+004 6.65710000e+004 6.52410000e+004\n",
            "         6.60170000e+004 6.60180000e+004 6.31830000e+004 6.21910000e+004\n",
            "         6.21920000e+004 6.60190000e+004 6.31840000e+004 6.21930000e+004\n",
            "         6.21940000e+004 6.65720000e+004 6.21950000e+004 6.65730000e+004\n",
            "         6.31850000e+004 6.65740000e+004 6.65750000e+004 6.21960000e+004\n",
            "         6.31860000e+004 6.65760000e+004 6.65770000e+004 6.31870000e+004\n",
            "         6.31880000e+004 6.65780000e+004 6.21970000e+004 6.31890000e+004\n",
            "         6.60200000e+004 6.60210000e+004 6.60220000e+004 6.21980000e+004\n",
            "         6.31900000e+004 6.31910000e+004 6.21990000e+004 6.03000000e+004\n",
            "         6.52420000e+004 6.65790000e+004 6.31920000e+004 6.65800000e+004\n",
            "         6.65810000e+004 6.60230000e+004 6.31930000e+004 6.31940000e+004\n",
            "         6.31950000e+004 6.22000000e+004 6.22010000e+004 6.22020000e+004\n",
            "         6.60240000e+004 6.65820000e+004 6.65830000e+004 6.60250000e+004\n",
            "         6.60260000e+004 6.60270000e+004 6.60280000e+004 5.86890000e+004\n",
            "         6.65840000e+004 6.31960000e+004 6.60290000e+004 6.22030000e+004\n",
            "         6.65850000e+004 6.31970000e+004 6.65860000e+004 6.65870000e+004\n",
            "         6.31980000e+004 6.31990000e+004 6.22040000e+004 6.22050000e+004\n",
            "         5.86900000e+004 6.60300000e+004 6.03010000e+004 6.65880000e+004\n",
            "         6.32000000e+004 6.65890000e+004 6.65900000e+004 6.65910000e+004\n",
            "         6.65920000e+004 6.60310000e+004 6.52430000e+004 6.60320000e+004\n",
            "         6.52440000e+004 6.52450000e+004 6.32010000e+004 6.32020000e+004\n",
            "         6.03020000e+004 6.65930000e+004 6.60330000e+004 6.32030000e+004\n",
            "         6.32040000e+004 6.32050000e+004 6.60340000e+004 6.03030000e+004\n",
            "         6.60350000e+004 6.32060000e+004 6.65940000e+004 6.65950000e+004\n",
            "         6.60360000e+004 6.03040000e+004 6.32070000e+004 6.65960000e+004\n",
            "         6.22060000e+004 6.32080000e+004 6.32090000e+004 6.65970000e+004\n",
            "         6.22070000e+004 6.22080000e+004 6.22090000e+004 6.65980000e+004\n",
            "         6.60370000e+004 6.60380000e+004 6.65990000e+004 6.22100000e+004\n",
            "         6.60390000e+004 6.03050000e+004 5.86910000e+004 6.66000000e+004\n",
            "         6.32100000e+004 6.22110000e+004 6.32110000e+004 6.60400000e+004\n",
            "         5.86920000e+004 6.60410000e+004 6.60420000e+004 6.60430000e+004\n",
            "         6.60440000e+004 6.66010000e+004 6.60450000e+004 6.60460000e+004\n",
            "         6.66020000e+004 5.86930000e+004 6.32120000e+004 6.32130000e+004\n",
            "         6.22120000e+004 6.66030000e+004 6.66040000e+004 6.66050000e+004\n",
            "         6.66060000e+004 6.66070000e+004 6.03060000e+004 6.60470000e+004\n",
            "         5.86940000e+004 6.60480000e+004 6.66080000e+004 6.22130000e+004\n",
            "         6.66090000e+004 6.66100000e+004 5.86950000e+004 6.60490000e+004\n",
            "         6.66110000e+004 6.60500000e+004 6.32140000e+004 6.66120000e+004\n",
            "         6.66130000e+004 6.66140000e+004 6.60510000e+004 6.60520000e+004\n",
            "         6.60530000e+004 6.79200000e+004 6.60540000e+004 6.60550000e+004\n",
            "         6.60560000e+004 5.86960000e+004 6.66150000e+004 6.22140000e+004\n",
            "         6.60570000e+004 6.66160000e+004 6.66170000e+004 5.86970000e+004\n",
            "         6.66180000e+004 6.66190000e+004 6.66200000e+004 6.22150000e+004\n",
            "         6.03070000e+004 6.60580000e+004 6.60590000e+004 6.32150000e+004\n",
            "         6.52460000e+004 6.22160000e+004 6.22170000e+004 6.66210000e+004\n",
            "         6.60600000e+004 6.60610000e+004 6.79210000e+004 6.66220000e+004\n",
            "         6.60620000e+004 6.60630000e+004 6.60640000e+004 6.60650000e+004\n",
            "         6.03080000e+004 6.66230000e+004 6.66240000e+004 6.22180000e+004\n",
            "         6.60660000e+004 6.60670000e+004 6.60680000e+004 6.32160000e+004\n",
            "         6.60690000e+004 6.60700000e+004 6.60710000e+004 6.60720000e+004\n",
            "         6.66250000e+004 6.66260000e+004 6.66270000e+004 6.66280000e+004\n",
            "         6.32170000e+004 6.32180000e+004 6.03090000e+004 6.66290000e+004\n",
            "         6.66300000e+004 6.66310000e+004 6.66320000e+004 6.66330000e+004\n",
            "         6.66340000e+004 6.52470000e+004 6.22190000e+004 6.22200000e+004\n",
            "         6.32190000e+004 6.51910000e+004 6.51920000e+004 6.58130000e+004\n",
            "         6.32200000e+004 6.51930000e+004 6.60730000e+004 6.60740000e+004\n",
            "         6.66350000e+004 6.66360000e+004 6.32210000e+004 6.32220000e+004\n",
            "         6.32230000e+004 6.32240000e+004 6.32250000e+004 6.58140000e+004\n",
            "         6.32260000e+004 5.86980000e+004 5.86990000e+004 6.03100000e+004\n",
            "         6.66370000e+004 6.32270000e+004 6.32280000e+004 6.58150000e+004\n",
            "         6.58160000e+004 6.58170000e+004 6.60750000e+004 6.60760000e+004\n",
            "         6.60770000e+004 6.51660000e+004 6.03110000e+004 6.66380000e+004\n",
            "         6.32290000e+004 6.22210000e+004 6.32300000e+004 6.58180000e+004\n",
            "         6.66390000e+004 6.66400000e+004 6.66410000e+004 6.32310000e+004\n",
            "         6.66420000e+004 6.32320000e+004 6.22220000e+004 6.32330000e+004\n",
            "         6.32340000e+004 6.51670000e+004 6.22230000e+004 6.22240000e+004\n",
            "         6.60780000e+004 6.66430000e+004 6.66440000e+004 6.22250000e+004\n",
            "         6.66450000e+004 6.66460000e+004 6.32350000e+004 6.60790000e+004\n",
            "         6.22260000e+004 6.32360000e+004 6.32370000e+004 6.32380000e+004\n",
            "         6.32390000e+004 6.60800000e+004 6.60810000e+004 6.60820000e+004\n",
            "         6.66470000e+004 6.66480000e+004 6.66490000e+004 6.22270000e+004\n",
            "         6.22280000e+004 6.22290000e+004 6.60830000e+004 6.32400000e+004\n",
            "         6.22300000e+004 6.32410000e+004 5.87000000e+004 6.66500000e+004\n",
            "         6.60840000e+004 6.60850000e+004 6.58190000e+004 6.51940000e+004\n",
            "         6.58200000e+004 6.32420000e+004 6.66510000e+004 6.66520000e+004\n",
            "         6.32430000e+004 6.60860000e+004 6.32440000e+004 6.32450000e+004\n",
            "         6.66530000e+004 6.66540000e+004 6.66550000e+004 6.60870000e+004\n",
            "         6.60880000e+004 6.66560000e+004 6.22310000e+004 6.58210000e+004\n",
            "         6.58220000e+004 6.22320000e+004 6.60890000e+004 6.22330000e+004\n",
            "         6.60900000e+004 6.66570000e+004 6.60910000e+004 6.60920000e+004\n",
            "         6.60930000e+004 6.60940000e+004 6.60950000e+004 6.60960000e+004\n",
            "         6.79220000e+004 6.66580000e+004 6.66590000e+004 6.66600000e+004\n",
            "         6.60970000e+004 6.60980000e+004 6.52480000e+004 6.60990000e+004\n",
            "         6.61000000e+004 6.61010000e+004 6.61020000e+004 6.61030000e+004\n",
            "         6.61040000e+004 6.61050000e+004 6.61060000e+004 6.61070000e+004\n",
            "         6.66610000e+004 6.52490000e+004 6.66620000e+004 6.32460000e+004\n",
            "         6.32470000e+004 6.32480000e+004 6.32490000e+004 6.66630000e+004\n",
            "         6.66640000e+004 6.22340000e+004 6.61080000e+004 6.61090000e+004\n",
            "         6.66650000e+004 6.66660000e+004 6.79070000e+004 6.69210000e+004\n",
            "         6.69220000e+004 6.69230000e+004 6.69240000e+004 6.69250000e+004\n",
            "         6.61100000e+004 6.61110000e+004 6.61120000e+004 6.61130000e+004\n",
            "         6.66670000e+004 6.61140000e+004 6.66680000e+004 6.66690000e+004\n",
            "         6.66700000e+004 6.66710000e+004 6.66720000e+004 6.52500000e+004\n",
            "         6.66730000e+004 5.90250000e+004 5.90260000e+004 6.66740000e+004\n",
            "         6.52510000e+004 6.66750000e+004 6.66760000e+004 6.66770000e+004\n",
            "         6.52520000e+004 6.79080000e+004 6.69260000e+004 6.79230000e+004\n",
            "         6.79240000e+004 6.79250000e+004 6.79260000e+004 6.79270000e+004\n",
            "         6.61150000e+004 6.51680000e+004 6.51690000e+004 6.66780000e+004\n",
            "         6.79280000e+004 6.61160000e+004 6.61170000e+004 6.61180000e+004\n",
            "         6.61190000e+004 6.61200000e+004 6.61210000e+004 6.61220000e+004\n",
            "         6.32500000e+004 5.90270000e+004 6.69270000e+004 5.90280000e+004\n",
            "         5.90290000e+004 6.66790000e+004 6.79090000e+004 6.66800000e+004\n",
            "         6.61230000e+004 6.66810000e+004 6.79100000e+004 6.79110000e+004\n",
            "         6.66820000e+004 6.66830000e+004 6.66840000e+004 6.66850000e+004\n",
            "         6.61240000e+004 6.69280000e+004 6.69290000e+004 6.66860000e+004\n",
            "         6.66870000e+004 6.66880000e+004 6.61250000e+004 6.61260000e+004\n",
            "         6.61270000e+004 6.69300000e+004 6.52530000e+004 6.52540000e+004\n",
            "         6.69310000e+004 6.69320000e+004 6.69330000e+004 6.69340000e+004\n",
            "         6.52550000e+004 6.69350000e+004 6.69360000e+004 6.69370000e+004\n",
            "         6.66890000e+004 6.66900000e+004 5.87010000e+004 6.66910000e+004\n",
            "         6.69380000e+004 6.61280000e+004 6.61290000e+004 6.69390000e+004\n",
            "         6.69400000e+004 6.66920000e+004 6.66930000e+004 6.61300000e+004\n",
            "         6.61310000e+004 6.66940000e+004 6.66950000e+004 6.66960000e+004\n",
            "         6.66970000e+004 6.66980000e+004 6.52560000e+004 6.61320000e+004\n",
            "         6.61330000e+004 6.52570000e+004 6.52580000e+004 6.52590000e+004\n",
            "         6.52600000e+004 6.61340000e+004 6.66990000e+004 5.91020000e+004\n",
            "         5.91030000e+004 6.52610000e+004 6.52620000e+004 6.52630000e+004\n",
            "         6.52640000e+004 6.52650000e+004 6.61350000e+004 6.61360000e+004\n",
            "         6.61370000e+004 5.89730000e+004 6.67000000e+004 6.69410000e+004\n",
            "         6.69420000e+004 6.69430000e+004 6.69440000e+004 6.03120000e+004\n",
            "         5.89740000e+004 6.32510000e+004 6.32520000e+004 6.32530000e+004\n",
            "         6.61380000e+004 6.52660000e+004 6.69450000e+004 6.69460000e+004\n",
            "         6.69470000e+004 6.69480000e+004 5.93250000e+004 5.89750000e+004\n",
            "         5.89760000e+004 6.32540000e+004 5.89770000e+004 5.87020000e+004\n",
            "         6.61390000e+004 5.93260000e+004 5.93270000e+004 6.61400000e+004\n",
            "         6.69490000e+004 6.69500000e+004 6.69510000e+004 6.69520000e+004\n",
            "         6.69530000e+004 6.69540000e+004 6.32550000e+004 6.32560000e+004\n",
            "         6.69550000e+004 6.69560000e+004 6.58230000e+004 6.03130000e+004\n",
            "         6.61410000e+004 6.61420000e+004 5.91040000e+004 6.61430000e+004\n",
            "         6.69570000e+004 6.69580000e+004 6.69590000e+004 6.69600000e+004\n",
            "         6.69610000e+004 6.69620000e+004 6.69630000e+004 6.58240000e+004\n",
            "         5.91050000e+004 5.91060000e+004 5.91070000e+004 5.91080000e+004\n",
            "         5.91090000e+004 6.69640000e+004 6.69650000e+004 6.69660000e+004\n",
            "         6.69670000e+004 6.52670000e+004 6.52680000e+004 6.58250000e+004\n",
            "         6.69680000e+004 6.61440000e+004 6.61450000e+004 6.58260000e+004\n",
            "         6.58270000e+004 6.58280000e+004 6.58290000e+004 5.91100000e+004\n",
            "         6.69690000e+004 6.58300000e+004 6.58310000e+004 6.58320000e+004\n",
            "         6.32570000e+004 6.58330000e+004 6.58340000e+004 6.58350000e+004\n",
            "         6.58360000e+004 6.58370000e+004 6.58380000e+004 6.61460000e+004\n",
            "         6.58390000e+004 6.58400000e+004 6.61470000e+004 5.91110000e+004\n",
            "         6.69700000e+004 6.69710000e+004 6.69720000e+004 6.69730000e+004\n",
            "         6.69740000e+004 6.58410000e+004 6.58420000e+004 6.79290000e+004\n",
            "         6.79300000e+004 5.91120000e+004 5.91130000e+004 6.69750000e+004\n",
            "         6.69760000e+004 6.58430000e+004 5.91140000e+004 5.91150000e+004\n",
            "         5.91160000e+004 6.69770000e+004 6.52690000e+004 5.91170000e+004\n",
            "         5.91180000e+004 5.91190000e+004 6.58440000e+004 6.61480000e+004\n",
            "         6.61490000e+004 6.69780000e+004 6.69790000e+004 6.69800000e+004\n",
            "         6.67010000e+004 6.61500000e+004 5.91200000e+004 5.91210000e+004\n",
            "         6.58450000e+004 6.69810000e+004 6.58460000e+004 6.58470000e+004\n",
            "         6.58480000e+004 5.91220000e+004 5.91230000e+004 6.67020000e+004\n",
            "         6.67030000e+004 6.67040000e+004 6.67050000e+004 6.67060000e+004\n",
            "         6.67070000e+004 6.69820000e+004 5.91240000e+004 5.91250000e+004\n",
            "         5.91260000e+004 6.52700000e+004 5.91270000e+004 6.69830000e+004\n",
            "         6.58490000e+004 6.58500000e+004 6.58510000e+004 6.61510000e+004\n",
            "         6.52710000e+004 6.67080000e+004 6.61520000e+004 6.61530000e+004\n",
            "         6.58520000e+004 6.58530000e+004 6.58540000e+004 6.67090000e+004\n",
            "         6.67100000e+004 6.67110000e+004 6.67120000e+004 6.67130000e+004\n",
            "         6.69840000e+004 6.69850000e+004 6.69860000e+004 5.91280000e+004\n",
            "         6.69870000e+004 6.61540000e+004 6.61550000e+004 3.67660000e+004\n",
            "         6.52720000e+004 6.61560000e+004 6.61570000e+004 6.67140000e+004\n",
            "         6.67150000e+004 6.67160000e+004 6.67170000e+004 6.58550000e+004\n",
            "         6.67180000e+004 6.67190000e+004 6.67200000e+004 6.67210000e+004\n",
            "         6.67220000e+004 6.67230000e+004 3.68990000e+004 6.61580000e+004\n",
            "         6.69880000e+004 6.61590000e+004 6.67240000e+004 3.67920000e+004\n",
            "         3.64680000e+004 6.67250000e+004 6.58560000e+004 3.69000000e+004\n",
            "         6.67260000e+004 6.52730000e+004 6.52740000e+004 6.52750000e+004\n",
            "         6.58570000e+004 6.58580000e+004 6.58590000e+004 6.61600000e+004\n",
            "         6.61610000e+004 3.67960000e+004 6.58600000e+004 3.64690000e+004\n",
            "         6.67270000e+004 6.52760000e+004 6.52770000e+004 6.52780000e+004\n",
            "         6.52790000e+004 6.58610000e+004 6.58620000e+004 6.58630000e+004\n",
            "         6.58640000e+004 6.58650000e+004 6.52800000e+004 6.58660000e+004\n",
            "         6.67280000e+004 6.67290000e+004 6.67300000e+004 6.67310000e+004\n",
            "         6.32580000e+004 6.73190000e+004 6.73200000e+004 6.32590000e+004\n",
            "         6.52810000e+004 6.52820000e+004 6.22360000e+004 6.58670000e+004\n",
            "         6.58680000e+004 6.58690000e+004 6.32600000e+004 6.32610000e+004\n",
            "         6.69890000e+004 6.69900000e+004 6.73210000e+004 6.22370000e+004\n",
            "         6.69910000e+004 6.69920000e+004 6.69930000e+004 6.69940000e+004\n",
            "         6.32620000e+004 6.69950000e+004 6.69960000e+004 6.58700000e+004\n",
            "         6.69970000e+004 6.69980000e+004 6.69990000e+004 6.70000000e+004\n",
            "         6.32630000e+004 6.32640000e+004 5.89780000e+004 6.61620000e+004\n",
            "         6.61630000e+004 6.70010000e+004 6.24270000e+004 6.24280000e+004\n",
            "         6.74270000e+004 6.61640000e+004 6.70020000e+004 6.70030000e+004\n",
            "         6.70040000e+004 6.22380000e+004 6.58710000e+004 6.70050000e+004\n",
            "         6.70060000e+004 6.58720000e+004 6.58730000e+004 6.70070000e+004\n",
            "         6.24290000e+004 5.91290000e+004 6.24300000e+004 6.70080000e+004\n",
            "         6.70090000e+004 6.70100000e+004 6.58740000e+004 6.58750000e+004\n",
            "         5.89790000e+004 6.61650000e+004 6.61660000e+004 6.61670000e+004\n",
            "         6.24310000e+004 6.24320000e+004 6.24330000e+004 6.24340000e+004\n",
            "         3.67670000e+004 5.91300000e+004 5.91310000e+004 5.91320000e+004\n",
            "         6.70110000e+004 6.61680000e+004 6.70120000e+004 6.70130000e+004\n",
            "         6.70140000e+004 6.58760000e+004 6.70150000e+004 6.70160000e+004\n",
            "         6.70170000e+004 6.70180000e+004 6.24350000e+004 6.24360000e+004\n",
            "         6.24370000e+004 6.32650000e+004 5.91330000e+004 6.74280000e+004\n",
            "         5.91340000e+004 5.91350000e+004 6.32660000e+004 6.70190000e+004\n",
            "         6.70200000e+004 6.61690000e+004 6.70210000e+004 5.22310000e+004\n",
            "         5.91360000e+004 5.91370000e+004 6.24380000e+004 6.24390000e+004\n",
            "         6.24400000e+004 5.22320000e+004 6.24410000e+004 5.91380000e+004\n",
            "         5.91390000e+004 5.91400000e+004 6.24420000e+004 6.70220000e+004\n",
            "         6.70230000e+004 6.24430000e+004 6.24440000e+004 6.74290000e+004\n",
            "         5.91410000e+004 5.91420000e+004 5.91430000e+004 5.91440000e+004\n",
            "         5.91450000e+004 6.70240000e+004 6.32670000e+004 6.52830000e+004\n",
            "         6.52840000e+004 6.52850000e+004 6.61700000e+004 6.24450000e+004\n",
            "         6.24460000e+004 6.74300000e+004 6.52860000e+004 6.24470000e+004\n",
            "         6.61710000e+004 6.61720000e+004 6.52870000e+004 5.22330000e+004\n",
            "         5.22340000e+004 6.70250000e+004 6.52880000e+004 6.52890000e+004\n",
            "         6.52900000e+004 6.70260000e+004 5.22350000e+004 6.24480000e+004\n",
            "         6.24490000e+004 6.24500000e+004 6.24510000e+004 6.52910000e+004\n",
            "         6.58770000e+004 6.58780000e+004 5.91460000e+004 6.52920000e+004\n",
            "         6.52930000e+004 6.70270000e+004 6.70280000e+004 6.74310000e+004\n",
            "         6.74320000e+004 6.70290000e+004 6.61730000e+004 6.24520000e+004\n",
            "         6.24530000e+004 6.24540000e+004 6.32680000e+004 6.32690000e+004\n",
            "         6.32700000e+004 6.61740000e+004 6.61750000e+004 6.61760000e+004\n",
            "         6.61770000e+004 6.70300000e+004 6.74330000e+004 6.70310000e+004\n",
            "         6.74340000e+004 6.70320000e+004 5.22360000e+004 6.24550000e+004\n",
            "         6.24560000e+004 6.52940000e+004 6.70330000e+004 6.70340000e+004\n",
            "         6.70350000e+004 6.52950000e+004 6.52960000e+004 6.70360000e+004\n",
            "         6.70370000e+004 6.74350000e+004 6.52970000e+004 6.74360000e+004\n",
            "         6.52980000e+004 6.74370000e+004 6.70380000e+004 6.61780000e+004\n",
            "         6.61790000e+004 6.32710000e+004 6.70390000e+004 6.70400000e+004\n",
            "         6.70410000e+004 6.61800000e+004 6.61810000e+004 6.70420000e+004\n",
            "         6.70430000e+004 6.74380000e+004 3.67680000e+004 6.74390000e+004\n",
            "         6.52990000e+004 6.24570000e+004 6.70440000e+004 5.22370000e+004\n",
            "         3.67690000e+004 6.70450000e+004 6.61820000e+004 6.61830000e+004\n",
            "         6.61840000e+004 6.70460000e+004 6.70470000e+004 6.61850000e+004\n",
            "         6.61860000e+004 6.74400000e+004 6.70480000e+004 6.53000000e+004\n",
            "         6.70490000e+004 6.53010000e+004 6.74410000e+004 6.70500000e+004\n"});
        len = __base::card::card_split(data, data.size(), lines);
        gsetmemb probe(lines, len);


        CHECK(probe.NFIELD == 1024);
        CHECK(probe.ISREF == 176);
        CHECK(probe.INDEX == 1);
        CHECK(probe.ISTYPE == gsetmemb::types::ELEM_SET);
        CHECK(probe.ISORIG == gsetmemb::origins::UNDEF_ORIGIN);
        CHECK(probe.IRMEMB.size() == 1019);
        CHECK(probe.IRMEMB == std::vector<long>({
            65977, 65978, 65807, 62174, 65808, 65809, 58683, 60294,
            62175, 65979, 60295, 60296, 62176, 62177, 62178, 63160,
            65980, 65238, 63161, 67917, 65981, 63162, 63163, 63164,
            58684, 66557, 62179, 62180, 62181, 62182, 65982, 66558,
            65983, 65984, 63166, 62183, 62184, 65985, 63167, 63168,
            65810, 65986, 65811, 65987, 62185, 58685, 65988, 65989,
            36898, 63169, 63170, 58686, 65990, 63172, 63173, 63174,
            63175, 63176, 65239, 63177, 63178, 62186, 62187, 66559,
            66560, 65991, 65992, 65993, 66561, 65994, 65995, 65996,
            65812, 66562, 66563, 65997, 65998, 58687, 60297, 66564,
            60298, 63179, 62188, 63180, 60299, 66565, 66566, 62189,
            62190, 66567, 66568, 65999, 63181, 66000, 66001, 67918,
            66002, 66003, 66569, 66004, 66005, 66006, 66570, 66007,
            66008, 66009, 66010, 66011, 66012, 63182, 66013, 66014,
            58688, 67919, 65240, 66015, 66016, 66571, 65241, 66017,
            66018, 63183, 62191, 62192, 66019, 63184, 62193, 62194,
            66572, 62195, 66573, 63185, 66574, 66575, 62196, 63186,
            66576, 66577, 63187, 63188, 66578, 62197, 63189, 66020,
            66021, 66022, 62198, 63190, 63191, 62199, 60300, 65242,
            66579, 63192, 66580, 66581, 66023, 63193, 63194, 63195,
            62200, 62201, 62202, 66024, 66582, 66583, 66025, 66026,
            66027, 66028, 58689, 66584, 63196, 66029, 62203, 66585,
            63197, 66586, 66587, 63198, 63199, 62204, 62205, 58690,
            66030, 60301, 66588, 63200, 66589, 66590, 66591, 66592,
            66031, 65243, 66032, 65244, 65245, 63201, 63202, 60302,
            66593, 66033, 63203, 63204, 63205, 66034, 60303, 66035,
            63206, 66594, 66595, 66036, 60304, 63207, 66596, 62206,
            63208, 63209, 66597, 62207, 62208, 62209, 66598, 66037,
            66038, 66599, 62210, 66039, 60305, 58691, 66600, 63210,
            62211, 63211, 66040, 58692, 66041, 66042, 66043, 66044,
            66601, 66045, 66046, 66602, 58693, 63212, 63213, 62212,
            66603, 66604, 66605, 66606, 66607, 60306, 66047, 58694,
            66048, 66608, 62213, 66609, 66610, 58695, 66049, 66611,
            66050, 63214, 66612, 66613, 66614, 66051, 66052, 66053,
            67920, 66054, 66055, 66056, 58696, 66615, 62214, 66057,
            66616, 66617, 58697, 66618, 66619, 66620, 62215, 60307,
            66058, 66059, 63215, 65246, 62216, 62217, 66621, 66060,
            66061, 67921, 66622, 66062, 66063, 66064, 66065, 60308,
            66623, 66624, 62218, 66066, 66067, 66068, 63216, 66069,
            66070, 66071, 66072, 66625, 66626, 66627, 66628, 63217,
            63218, 60309, 66629, 66630, 66631, 66632, 66633, 66634,
            65247, 62219, 62220, 63219, 65191, 65192, 65813, 63220,
            65193, 66073, 66074, 66635, 66636, 63221, 63222, 63223,
            63224, 63225, 65814, 63226, 58698, 58699, 60310, 66637,
            63227, 63228, 65815, 65816, 65817, 66075, 66076, 66077,
            65166, 60311, 66638, 63229, 62221, 63230, 65818, 66639,
            66640, 66641, 63231, 66642, 63232, 62222, 63233, 63234,
            65167, 62223, 62224, 66078, 66643, 66644, 62225, 66645,
            66646, 63235, 66079, 62226, 63236, 63237, 63238, 63239,
            66080, 66081, 66082, 66647, 66648, 66649, 62227, 62228,
            62229, 66083, 63240, 62230, 63241, 58700, 66650, 66084,
            66085, 65819, 65194, 65820, 63242, 66651, 66652, 63243,
            66086, 63244, 63245, 66653, 66654, 66655, 66087, 66088,
            66656, 62231, 65821, 65822, 62232, 66089, 62233, 66090,
            66657, 66091, 66092, 66093, 66094, 66095, 66096, 67922,
            66658, 66659, 66660, 66097, 66098, 65248, 66099, 66100,
            66101, 66102, 66103, 66104, 66105, 66106, 66107, 66661,
            65249, 66662, 63246, 63247, 63248, 63249, 66663, 66664,
            62234, 66108, 66109, 66665, 66666, 67907, 66921, 66922,
            66923, 66924, 66925, 66110, 66111, 66112, 66113, 66667,
            66114, 66668, 66669, 66670, 66671, 66672, 65250, 66673,
            59025, 59026, 66674, 65251, 66675, 66676, 66677, 65252,
            67908, 66926, 67923, 67924, 67925, 67926, 67927, 66115,
            65168, 65169, 66678, 67928, 66116, 66117, 66118, 66119,
            66120, 66121, 66122, 63250, 59027, 66927, 59028, 59029,
            66679, 67909, 66680, 66123, 66681, 67910, 67911, 66682,
            66683, 66684, 66685, 66124, 66928, 66929, 66686, 66687,
            66688, 66125, 66126, 66127, 66930, 65253, 65254, 66931,
            66932, 66933, 66934, 65255, 66935, 66936, 66937, 66689,
            66690, 58701, 66691, 66938, 66128, 66129, 66939, 66940,
            66692, 66693, 66130, 66131, 66694, 66695, 66696, 66697,
            66698, 65256, 66132, 66133, 65257, 65258, 65259, 65260,
            66134, 66699, 59102, 59103, 65261, 65262, 65263, 65264,
            65265, 66135, 66136, 66137, 58973, 66700, 66941, 66942,
            66943, 66944, 60312, 58974, 63251, 63252, 63253, 66138,
            65266, 66945, 66946, 66947, 66948, 59325, 58975, 58976,
            63254, 58977, 58702, 66139, 59326, 59327, 66140, 66949,
            66950, 66951, 66952, 66953, 66954, 63255, 63256, 66955,
            66956, 65823, 60313, 66141, 66142, 59104, 66143, 66957,
            66958, 66959, 66960, 66961, 66962, 66963, 65824, 59105,
            59106, 59107, 59108, 59109, 66964, 66965, 66966, 66967,
            65267, 65268, 65825, 66968, 66144, 66145, 65826, 65827,
            65828, 65829, 59110, 66969, 65830, 65831, 65832, 63257,
            65833, 65834, 65835, 65836, 65837, 65838, 66146, 65839,
            65840, 66147, 59111, 66970, 66971, 66972, 66973, 66974,
            65841, 65842, 67929, 67930, 59112, 59113, 66975, 66976,
            65843, 59114, 59115, 59116, 66977, 65269, 59117, 59118,
            59119, 65844, 66148, 66149, 66978, 66979, 66980, 66701,
            66150, 59120, 59121, 65845, 66981, 65846, 65847, 65848,
            59122, 59123, 66702, 66703, 66704, 66705, 66706, 66707,
            66982, 59124, 59125, 59126, 65270, 59127, 66983, 65849,
            65850, 65851, 66151, 65271, 66708, 66152, 66153, 65852,
            65853, 65854, 66709, 66710, 66711, 66712, 66713, 66984,
            66985, 66986, 59128, 66987, 66154, 66155, 36766, 65272,
            66156, 66157, 66714, 66715, 66716, 66717, 65855, 66718,
            66719, 66720, 66721, 66722, 66723, 36899, 66158, 66988,
            66159, 66724, 36792, 36468, 66725, 65856, 36900, 66726,
            65273, 65274, 65275, 65857, 65858, 65859, 66160, 66161,
            36796, 65860, 36469, 66727, 65276, 65277, 65278, 65279,
            65861, 65862, 65863, 65864, 65865, 65280, 65866, 66728,
            66729, 66730, 66731, 63258, 67319, 67320, 63259, 65281,
            65282, 62236, 65867, 65868, 65869, 63260, 63261, 66989,
            66990, 67321, 62237, 66991, 66992, 66993, 66994, 63262,
            66995, 66996, 65870, 66997, 66998, 66999, 67000, 63263,
            63264, 58978, 66162, 66163, 67001, 62427, 62428, 67427,
            66164, 67002, 67003, 67004, 62238, 65871, 67005, 67006,
            65872, 65873, 67007, 62429, 59129, 62430, 67008, 67009,
            67010, 65874, 65875, 58979, 66165, 66166, 66167, 62431,
            62432, 62433, 62434, 36767, 59130, 59131, 59132, 67011,
            66168, 67012, 67013, 67014, 65876, 67015, 67016, 67017,
            67018, 62435, 62436, 62437, 63265, 59133, 67428, 59134,
            59135, 63266, 67019, 67020, 66169, 67021, 52231, 59136,
            59137, 62438, 62439, 62440, 52232, 62441, 59138, 59139,
            59140, 62442, 67022, 67023, 62443, 62444, 67429, 59141,
            59142, 59143, 59144, 59145, 67024, 63267, 65283, 65284,
            65285, 66170, 62445, 62446, 67430, 65286, 62447, 66171,
            66172, 65287, 52233, 52234, 67025, 65288, 65289, 65290,
            67026, 52235, 62448, 62449, 62450, 62451, 65291, 65877,
            65878, 59146, 65292, 65293, 67027, 67028, 67431, 67432,
            67029, 66173, 62452, 62453, 62454, 63268, 63269, 63270,
            66174, 66175, 66176, 66177, 67030, 67433, 67031, 67434,
            67032, 52236, 62455, 62456, 65294, 67033, 67034, 67035,
            65295, 65296, 67036, 67037, 67435, 65297, 67436, 65298,
            67437, 67038, 66178, 66179, 63271, 67039, 67040, 67041,
            66180, 66181, 67042, 67043, 67438, 36768, 67439, 65299,
            62457, 67044, 52237, 36769, 67045, 66182, 66183, 66184,
            67046, 67047, 66185, 66186, 67440, 67048, 65300, 67049,
            65301, 67441, 67050}));
    }
}

TEST_CASE("FEM GSETMEMB types output.", "[fem_gsetmemb,out]") {

    std::ostringstream test;

    SECTION("empty") {
        gsetmemb probe;
        test << probe;
        CHECK(test.str() == "");
    }

    SECTION("simple") {
        gsetmemb probe(5, 2, 3, gsetmemb::types::ELEM_SET, gsetmemb::origins::LINE_OR_CURVE_ORIGIN);
        test << probe;
        CHECK(test.str() ==
              "GSETMEMB+5.000000000e+00+2.000000000e+00+3.000000000e+00+2.000000000e+00\n"
              "        +2.000000000e+00\n");
    }

    SECTION("simple (2)") {
        std::vector<long> ref_irmemb(0);
        gsetmemb probe(5, 2, 3, gsetmemb::types::NODE_SET, gsetmemb::origins::POINT_ORIGIN, ref_irmemb);
        test << probe;
        CHECK(test.str() ==
              "GSETMEMB+5.000000000e+00+2.000000000e+00+3.000000000e+00+1.000000000e+00\n"
              "        +1.000000000e+00\n");
    }

    SECTION("calc NFIELD") {
        gsetmemb probe(2, 3, gsetmemb::types::ELEM_SET, gsetmemb::origins::BODY_ORIGIN);
        test << probe;
        CHECK(test.str() ==
              "GSETMEMB+5.000000000e+00+2.000000000e+00+3.000000000e+00+2.000000000e+00\n"
              "        +4.000000000e+00\n");
    }

    SECTION("calc NFIELD (2)") {
        std::vector<long> ref_irmemb(0);
        gsetmemb probe(2, 3, gsetmemb::types::ELEM_SET, gsetmemb::origins::SURFACE_ORIGIN, ref_irmemb);
        test << probe;
        CHECK(test.str() ==
              "GSETMEMB+5.000000000e+00+2.000000000e+00+3.000000000e+00+2.000000000e+00\n"
              "        +3.000000000e+00\n");
    }

    std::string ref_1(
        "GSETMEMB+1.024000000e+03+2.000000000e+00+3.000000000e+00+1.000000000e+00\n"
        "        +2.000000000e+00+1.000000000e+01+1.100000000e+01+1.200000000e+01\n"
        "        +1.300000000e+01+1.400000000e+01+1.500000000e+01+1.600000000e+01\n"
        "        +1.700000000e+01+1.800000000e+01+1.900000000e+01+2.000000000e+01\n"
        "        +2.100000000e+01+2.200000000e+01+2.300000000e+01+2.400000000e+01\n"
        "        +2.500000000e+01+2.600000000e+01+2.700000000e+01+2.800000000e+01\n"
        "        +2.900000000e+01+3.000000000e+01+3.100000000e+01+3.200000000e+01\n"
        "        +3.300000000e+01+3.400000000e+01+3.500000000e+01+3.600000000e+01\n"
        "        +3.700000000e+01+3.800000000e+01+3.900000000e+01+4.000000000e+01\n"
        "        +4.100000000e+01+4.200000000e+01+4.300000000e+01+4.400000000e+01\n"
        "        +4.500000000e+01+4.600000000e+01+4.700000000e+01+4.800000000e+01\n"
        "        +4.900000000e+01+5.000000000e+01+5.100000000e+01+5.200000000e+01\n"
        "        +5.300000000e+01+5.400000000e+01+5.500000000e+01+5.600000000e+01\n"
        "        +5.700000000e+01+5.800000000e+01+5.900000000e+01+6.000000000e+01\n"
        "        +6.100000000e+01+6.200000000e+01+6.300000000e+01+6.400000000e+01\n"
        "        +6.500000000e+01+6.600000000e+01+6.700000000e+01+6.800000000e+01\n"
        "        +6.900000000e+01+7.000000000e+01+7.100000000e+01+7.200000000e+01\n"
        "        +7.300000000e+01+7.400000000e+01+7.500000000e+01+7.600000000e+01\n"
        "        +7.700000000e+01+7.800000000e+01+7.900000000e+01+8.000000000e+01\n"
        "        +8.100000000e+01+8.200000000e+01+8.300000000e+01+8.400000000e+01\n"
        "        +8.500000000e+01+8.600000000e+01+8.700000000e+01+8.800000000e+01\n"
        "        +8.900000000e+01+9.000000000e+01+9.100000000e+01+9.200000000e+01\n"
        "        +9.300000000e+01+9.400000000e+01+9.500000000e+01+9.600000000e+01\n"
        "        +9.700000000e+01+9.800000000e+01+9.900000000e+01+1.000000000e+02\n"
        "        +1.010000000e+02+1.020000000e+02+1.030000000e+02+1.040000000e+02\n"
        "        +1.050000000e+02+1.060000000e+02+1.070000000e+02+1.080000000e+02\n"
        "        +1.090000000e+02+1.100000000e+02+1.110000000e+02+1.120000000e+02\n"
        "        +1.130000000e+02+1.140000000e+02+1.150000000e+02+1.160000000e+02\n"
        "        +1.170000000e+02+1.180000000e+02+1.190000000e+02+1.200000000e+02\n"
        "        +1.210000000e+02+1.220000000e+02+1.230000000e+02+1.240000000e+02\n"
        "        +1.250000000e+02+1.260000000e+02+1.270000000e+02+1.280000000e+02\n"
        "        +1.290000000e+02+1.300000000e+02+1.310000000e+02+1.320000000e+02\n"
        "        +1.330000000e+02+1.340000000e+02+1.350000000e+02+1.360000000e+02\n"
        "        +1.370000000e+02+1.380000000e+02+1.390000000e+02+1.400000000e+02\n"
        "        +1.410000000e+02+1.420000000e+02+1.430000000e+02+1.440000000e+02\n"
        "        +1.450000000e+02+1.460000000e+02+1.470000000e+02+1.480000000e+02\n"
        "        +1.490000000e+02+1.500000000e+02+1.510000000e+02+1.520000000e+02\n"
        "        +1.530000000e+02+1.540000000e+02+1.550000000e+02+1.560000000e+02\n"
        "        +1.570000000e+02+1.580000000e+02+1.590000000e+02+1.600000000e+02\n"
        "        +1.610000000e+02+1.620000000e+02+1.630000000e+02+1.640000000e+02\n"
        "        +1.650000000e+02+1.660000000e+02+1.670000000e+02+1.680000000e+02\n"
        "        +1.690000000e+02+1.700000000e+02+1.710000000e+02+1.720000000e+02\n"
        "        +1.730000000e+02+1.740000000e+02+1.750000000e+02+1.760000000e+02\n"
        "        +1.770000000e+02+1.780000000e+02+1.790000000e+02+1.800000000e+02\n"
        "        +1.810000000e+02+1.820000000e+02+1.830000000e+02+1.840000000e+02\n"
        "        +1.850000000e+02+1.860000000e+02+1.870000000e+02+1.880000000e+02\n"
        "        +1.890000000e+02+1.900000000e+02+1.910000000e+02+1.920000000e+02\n"
        "        +1.930000000e+02+1.940000000e+02+1.950000000e+02+1.960000000e+02\n"
        "        +1.970000000e+02+1.980000000e+02+1.990000000e+02+2.000000000e+02\n"
        "        +2.010000000e+02+2.020000000e+02+2.030000000e+02+2.040000000e+02\n"
        "        +2.050000000e+02+2.060000000e+02+2.070000000e+02+2.080000000e+02\n"
        "        +2.090000000e+02+2.100000000e+02+2.110000000e+02+2.120000000e+02\n"
        "        +2.130000000e+02+2.140000000e+02+2.150000000e+02+2.160000000e+02\n"
        "        +2.170000000e+02+2.180000000e+02+2.190000000e+02+2.200000000e+02\n"
        "        +2.210000000e+02+2.220000000e+02+2.230000000e+02+2.240000000e+02\n"
        "        +2.250000000e+02+2.260000000e+02+2.270000000e+02+2.280000000e+02\n"
        "        +2.290000000e+02+2.300000000e+02+2.310000000e+02+2.320000000e+02\n"
        "        +2.330000000e+02+2.340000000e+02+2.350000000e+02+2.360000000e+02\n"
        "        +2.370000000e+02+2.380000000e+02+2.390000000e+02+2.400000000e+02\n"
        "        +2.410000000e+02+2.420000000e+02+2.430000000e+02+2.440000000e+02\n"
        "        +2.450000000e+02+2.460000000e+02+2.470000000e+02+2.480000000e+02\n"
        "        +2.490000000e+02+2.500000000e+02+2.510000000e+02+2.520000000e+02\n"
        "        +2.530000000e+02+2.540000000e+02+2.550000000e+02+2.560000000e+02\n"
        "        +2.570000000e+02+2.580000000e+02+2.590000000e+02+2.600000000e+02\n"
        "        +2.610000000e+02+2.620000000e+02+2.630000000e+02+2.640000000e+02\n"
        "        +2.650000000e+02+2.660000000e+02+2.670000000e+02+2.680000000e+02\n"
        "        +2.690000000e+02+2.700000000e+02+2.710000000e+02+2.720000000e+02\n"
        "        +2.730000000e+02+2.740000000e+02+2.750000000e+02+2.760000000e+02\n"
        "        +2.770000000e+02+2.780000000e+02+2.790000000e+02+2.800000000e+02\n"
        "        +2.810000000e+02+2.820000000e+02+2.830000000e+02+2.840000000e+02\n"
        "        +2.850000000e+02+2.860000000e+02+2.870000000e+02+2.880000000e+02\n"
        "        +2.890000000e+02+2.900000000e+02+2.910000000e+02+2.920000000e+02\n"
        "        +2.930000000e+02+2.940000000e+02+2.950000000e+02+2.960000000e+02\n"
        "        +2.970000000e+02+2.980000000e+02+2.990000000e+02+3.000000000e+02\n"
        "        +3.010000000e+02+3.020000000e+02+3.030000000e+02+3.040000000e+02\n"
        "        +3.050000000e+02+3.060000000e+02+3.070000000e+02+3.080000000e+02\n"
        "        +3.090000000e+02+3.100000000e+02+3.110000000e+02+3.120000000e+02\n"
        "        +3.130000000e+02+3.140000000e+02+3.150000000e+02+3.160000000e+02\n"
        "        +3.170000000e+02+3.180000000e+02+3.190000000e+02+3.200000000e+02\n"
        "        +3.210000000e+02+3.220000000e+02+3.230000000e+02+3.240000000e+02\n"
        "        +3.250000000e+02+3.260000000e+02+3.270000000e+02+3.280000000e+02\n"
        "        +3.290000000e+02+3.300000000e+02+3.310000000e+02+3.320000000e+02\n"
        "        +3.330000000e+02+3.340000000e+02+3.350000000e+02+3.360000000e+02\n"
        "        +3.370000000e+02+3.380000000e+02+3.390000000e+02+3.400000000e+02\n"
        "        +3.410000000e+02+3.420000000e+02+3.430000000e+02+3.440000000e+02\n"
        "        +3.450000000e+02+3.460000000e+02+3.470000000e+02+3.480000000e+02\n"
        "        +3.490000000e+02+3.500000000e+02+3.510000000e+02+3.520000000e+02\n"
        "        +3.530000000e+02+3.540000000e+02+3.550000000e+02+3.560000000e+02\n"
        "        +3.570000000e+02+3.580000000e+02+3.590000000e+02+3.600000000e+02\n"
        "        +3.610000000e+02+3.620000000e+02+3.630000000e+02+3.640000000e+02\n"
        "        +3.650000000e+02+3.660000000e+02+3.670000000e+02+3.680000000e+02\n"
        "        +3.690000000e+02+3.700000000e+02+3.710000000e+02+3.720000000e+02\n"
        "        +3.730000000e+02+3.740000000e+02+3.750000000e+02+3.760000000e+02\n"
        "        +3.770000000e+02+3.780000000e+02+3.790000000e+02+3.800000000e+02\n"
        "        +3.810000000e+02+3.820000000e+02+3.830000000e+02+3.840000000e+02\n"
        "        +3.850000000e+02+3.860000000e+02+3.870000000e+02+3.880000000e+02\n"
        "        +3.890000000e+02+3.900000000e+02+3.910000000e+02+3.920000000e+02\n"
        "        +3.930000000e+02+3.940000000e+02+3.950000000e+02+3.960000000e+02\n"
        "        +3.970000000e+02+3.980000000e+02+3.990000000e+02+4.000000000e+02\n"
        "        +4.010000000e+02+4.020000000e+02+4.030000000e+02+4.040000000e+02\n"
        "        +4.050000000e+02+4.060000000e+02+4.070000000e+02+4.080000000e+02\n"
        "        +4.090000000e+02+4.100000000e+02+4.110000000e+02+4.120000000e+02\n"
        "        +4.130000000e+02+4.140000000e+02+4.150000000e+02+4.160000000e+02\n"
        "        +4.170000000e+02+4.180000000e+02+4.190000000e+02+4.200000000e+02\n"
        "        +4.210000000e+02+4.220000000e+02+4.230000000e+02+4.240000000e+02\n"
        "        +4.250000000e+02+4.260000000e+02+4.270000000e+02+4.280000000e+02\n"
        "        +4.290000000e+02+4.300000000e+02+4.310000000e+02+4.320000000e+02\n"
        "        +4.330000000e+02+4.340000000e+02+4.350000000e+02+4.360000000e+02\n"
        "        +4.370000000e+02+4.380000000e+02+4.390000000e+02+4.400000000e+02\n"
        "        +4.410000000e+02+4.420000000e+02+4.430000000e+02+4.440000000e+02\n"
        "        +4.450000000e+02+4.460000000e+02+4.470000000e+02+4.480000000e+02\n");
    std::string ref_2(
        "        +4.490000000e+02+4.500000000e+02+4.510000000e+02+4.520000000e+02\n"
        "        +4.530000000e+02+4.540000000e+02+4.550000000e+02+4.560000000e+02\n"
        "        +4.570000000e+02+4.580000000e+02+4.590000000e+02+4.600000000e+02\n"
        "        +4.610000000e+02+4.620000000e+02+4.630000000e+02+4.640000000e+02\n"
        "        +4.650000000e+02+4.660000000e+02+4.670000000e+02+4.680000000e+02\n"
        "        +4.690000000e+02+4.700000000e+02+4.710000000e+02+4.720000000e+02\n"
        "        +4.730000000e+02+4.740000000e+02+4.750000000e+02+4.760000000e+02\n"
        "        +4.770000000e+02+4.780000000e+02+4.790000000e+02+4.800000000e+02\n"
        "        +4.810000000e+02+4.820000000e+02+4.830000000e+02+4.840000000e+02\n"
        "        +4.850000000e+02+4.860000000e+02+4.870000000e+02+4.880000000e+02\n"
        "        +4.890000000e+02+4.900000000e+02+4.910000000e+02+4.920000000e+02\n"
        "        +4.930000000e+02+4.940000000e+02+4.950000000e+02+4.960000000e+02\n"
        "        +4.970000000e+02+4.980000000e+02+4.990000000e+02+5.000000000e+02\n"
        "        +5.010000000e+02+5.020000000e+02+5.030000000e+02+5.040000000e+02\n"
        "        +5.050000000e+02+5.060000000e+02+5.070000000e+02+5.080000000e+02\n"
        "        +5.090000000e+02+5.100000000e+02+5.110000000e+02+5.120000000e+02\n"
        "        +5.130000000e+02+5.140000000e+02+5.150000000e+02+5.160000000e+02\n"
        "        +5.170000000e+02+5.180000000e+02+5.190000000e+02+5.200000000e+02\n"
        "        +5.210000000e+02+5.220000000e+02+5.230000000e+02+5.240000000e+02\n"
        "        +5.250000000e+02+5.260000000e+02+5.270000000e+02+5.280000000e+02\n"
        "        +5.290000000e+02+5.300000000e+02+5.310000000e+02+5.320000000e+02\n"
        "        +5.330000000e+02+5.340000000e+02+5.350000000e+02+5.360000000e+02\n"
        "        +5.370000000e+02+5.380000000e+02+5.390000000e+02+5.400000000e+02\n"
        "        +5.410000000e+02+5.420000000e+02+5.430000000e+02+5.440000000e+02\n"
        "        +5.450000000e+02+5.460000000e+02+5.470000000e+02+5.480000000e+02\n"
        "        +5.490000000e+02+5.500000000e+02+5.510000000e+02+5.520000000e+02\n"
        "        +5.530000000e+02+5.540000000e+02+5.550000000e+02+5.560000000e+02\n"
        "        +5.570000000e+02+5.580000000e+02+5.590000000e+02+5.600000000e+02\n"
        "        +5.610000000e+02+5.620000000e+02+5.630000000e+02+5.640000000e+02\n"
        "        +5.650000000e+02+5.660000000e+02+5.670000000e+02+5.680000000e+02\n"
        "        +5.690000000e+02+5.700000000e+02+5.710000000e+02+5.720000000e+02\n"
        "        +5.730000000e+02+5.740000000e+02+5.750000000e+02+5.760000000e+02\n"
        "        +5.770000000e+02+5.780000000e+02+5.790000000e+02+5.800000000e+02\n"
        "        +5.810000000e+02+5.820000000e+02+5.830000000e+02+5.840000000e+02\n"
        "        +5.850000000e+02+5.860000000e+02+5.870000000e+02+5.880000000e+02\n"
        "        +5.890000000e+02+5.900000000e+02+5.910000000e+02+5.920000000e+02\n"
        "        +5.930000000e+02+5.940000000e+02+5.950000000e+02+5.960000000e+02\n"
        "        +5.970000000e+02+5.980000000e+02+5.990000000e+02+6.000000000e+02\n"
        "        +6.010000000e+02+6.020000000e+02+6.030000000e+02+6.040000000e+02\n"
        "        +6.050000000e+02+6.060000000e+02+6.070000000e+02+6.080000000e+02\n"
        "        +6.090000000e+02+6.100000000e+02+6.110000000e+02+6.120000000e+02\n"
        "        +6.130000000e+02+6.140000000e+02+6.150000000e+02+6.160000000e+02\n"
        "        +6.170000000e+02+6.180000000e+02+6.190000000e+02+6.200000000e+02\n"
        "        +6.210000000e+02+6.220000000e+02+6.230000000e+02+6.240000000e+02\n"
        "        +6.250000000e+02+6.260000000e+02+6.270000000e+02+6.280000000e+02\n"
        "        +6.290000000e+02+6.300000000e+02+6.310000000e+02+6.320000000e+02\n"
        "        +6.330000000e+02+6.340000000e+02+6.350000000e+02+6.360000000e+02\n"
        "        +6.370000000e+02+6.380000000e+02+6.390000000e+02+6.400000000e+02\n"
        "        +6.410000000e+02+6.420000000e+02+6.430000000e+02+6.440000000e+02\n"
        "        +6.450000000e+02+6.460000000e+02+6.470000000e+02+6.480000000e+02\n"
        "        +6.490000000e+02+6.500000000e+02+6.510000000e+02+6.520000000e+02\n"
        "        +6.530000000e+02+6.540000000e+02+6.550000000e+02+6.560000000e+02\n"
        "        +6.570000000e+02+6.580000000e+02+6.590000000e+02+6.600000000e+02\n"
        "        +6.610000000e+02+6.620000000e+02+6.630000000e+02+6.640000000e+02\n"
        "        +6.650000000e+02+6.660000000e+02+6.670000000e+02+6.680000000e+02\n"
        "        +6.690000000e+02+6.700000000e+02+6.710000000e+02+6.720000000e+02\n"
        "        +6.730000000e+02+6.740000000e+02+6.750000000e+02+6.760000000e+02\n"
        "        +6.770000000e+02+6.780000000e+02+6.790000000e+02+6.800000000e+02\n"
        "        +6.810000000e+02+6.820000000e+02+6.830000000e+02+6.840000000e+02\n"
        "        +6.850000000e+02+6.860000000e+02+6.870000000e+02+6.880000000e+02\n"
        "        +6.890000000e+02+6.900000000e+02+6.910000000e+02+6.920000000e+02\n"
        "        +6.930000000e+02+6.940000000e+02+6.950000000e+02+6.960000000e+02\n"
        "        +6.970000000e+02+6.980000000e+02+6.990000000e+02+7.000000000e+02\n"
        "        +7.010000000e+02+7.020000000e+02+7.030000000e+02+7.040000000e+02\n"
        "        +7.050000000e+02+7.060000000e+02+7.070000000e+02+7.080000000e+02\n"
        "        +7.090000000e+02+7.100000000e+02+7.110000000e+02+7.120000000e+02\n"
        "        +7.130000000e+02+7.140000000e+02+7.150000000e+02+7.160000000e+02\n"
        "        +7.170000000e+02+7.180000000e+02+7.190000000e+02+7.200000000e+02\n"
        "        +7.210000000e+02+7.220000000e+02+7.230000000e+02+7.240000000e+02\n"
        "        +7.250000000e+02+7.260000000e+02+7.270000000e+02+7.280000000e+02\n"
        "        +7.290000000e+02+7.300000000e+02+7.310000000e+02+7.320000000e+02\n"
        "        +7.330000000e+02+7.340000000e+02+7.350000000e+02+7.360000000e+02\n"
        "        +7.370000000e+02+7.380000000e+02+7.390000000e+02+7.400000000e+02\n"
        "        +7.410000000e+02+7.420000000e+02+7.430000000e+02+7.440000000e+02\n"
        "        +7.450000000e+02+7.460000000e+02+7.470000000e+02+7.480000000e+02\n"
        "        +7.490000000e+02+7.500000000e+02+7.510000000e+02+7.520000000e+02\n"
        "        +7.530000000e+02+7.540000000e+02+7.550000000e+02+7.560000000e+02\n"
        "        +7.570000000e+02+7.580000000e+02+7.590000000e+02+7.600000000e+02\n"
        "        +7.610000000e+02+7.620000000e+02+7.630000000e+02+7.640000000e+02\n"
        "        +7.650000000e+02+7.660000000e+02+7.670000000e+02+7.680000000e+02\n"
        "        +7.690000000e+02+7.700000000e+02+7.710000000e+02+7.720000000e+02\n"
        "        +7.730000000e+02+7.740000000e+02+7.750000000e+02+7.760000000e+02\n"
        "        +7.770000000e+02+7.780000000e+02+7.790000000e+02+7.800000000e+02\n"
        "        +7.810000000e+02+7.820000000e+02+7.830000000e+02+7.840000000e+02\n"
        "        +7.850000000e+02+7.860000000e+02+7.870000000e+02+7.880000000e+02\n"
        "        +7.890000000e+02+7.900000000e+02+7.910000000e+02+7.920000000e+02\n"
        "        +7.930000000e+02+7.940000000e+02+7.950000000e+02+7.960000000e+02\n"
        "        +7.970000000e+02+7.980000000e+02+7.990000000e+02+8.000000000e+02\n"
        "        +8.010000000e+02+8.020000000e+02+8.030000000e+02+8.040000000e+02\n"
        "        +8.050000000e+02+8.060000000e+02+8.070000000e+02+8.080000000e+02\n"
        "        +8.090000000e+02+8.100000000e+02+8.110000000e+02+8.120000000e+02\n"
        "        +8.130000000e+02+8.140000000e+02+8.150000000e+02+8.160000000e+02\n"
        "        +8.170000000e+02+8.180000000e+02+8.190000000e+02+8.200000000e+02\n"
        "        +8.210000000e+02+8.220000000e+02+8.230000000e+02+8.240000000e+02\n"
        "        +8.250000000e+02+8.260000000e+02+8.270000000e+02+8.280000000e+02\n"
        "        +8.290000000e+02+8.300000000e+02+8.310000000e+02+8.320000000e+02\n"
        "        +8.330000000e+02+8.340000000e+02+8.350000000e+02+8.360000000e+02\n"
        "        +8.370000000e+02+8.380000000e+02+8.390000000e+02+8.400000000e+02\n"
        "        +8.410000000e+02+8.420000000e+02+8.430000000e+02+8.440000000e+02\n"
        "        +8.450000000e+02+8.460000000e+02+8.470000000e+02+8.480000000e+02\n"
        "        +8.490000000e+02+8.500000000e+02+8.510000000e+02+8.520000000e+02\n"
        "        +8.530000000e+02+8.540000000e+02+8.550000000e+02+8.560000000e+02\n"
        "        +8.570000000e+02+8.580000000e+02+8.590000000e+02+8.600000000e+02\n"
        "        +8.610000000e+02+8.620000000e+02+8.630000000e+02+8.640000000e+02\n"
        "        +8.650000000e+02+8.660000000e+02+8.670000000e+02+8.680000000e+02\n"
        "        +8.690000000e+02+8.700000000e+02+8.710000000e+02+8.720000000e+02\n"
        "        +8.730000000e+02+8.740000000e+02+8.750000000e+02+8.760000000e+02\n"
        "        +8.770000000e+02+8.780000000e+02+8.790000000e+02+8.800000000e+02\n"
        "        +8.810000000e+02+8.820000000e+02+8.830000000e+02+8.840000000e+02\n"
        "        +8.850000000e+02+8.860000000e+02+8.870000000e+02+8.880000000e+02\n"
        "        +8.890000000e+02+8.900000000e+02+8.910000000e+02+8.920000000e+02\n");
    std::string ref_3(
        "        +8.930000000e+02+8.940000000e+02+8.950000000e+02+8.960000000e+02\n"
        "        +8.970000000e+02+8.980000000e+02+8.990000000e+02+9.000000000e+02\n"
        "        +9.010000000e+02+9.020000000e+02+9.030000000e+02+9.040000000e+02\n"
        "        +9.050000000e+02+9.060000000e+02+9.070000000e+02+9.080000000e+02\n"
        "        +9.090000000e+02+9.100000000e+02+9.110000000e+02+9.120000000e+02\n"
        "        +9.130000000e+02+9.140000000e+02+9.150000000e+02+9.160000000e+02\n"
        "        +9.170000000e+02+9.180000000e+02+9.190000000e+02+9.200000000e+02\n"
        "        +9.210000000e+02+9.220000000e+02+9.230000000e+02+9.240000000e+02\n"
        "        +9.250000000e+02+9.260000000e+02+9.270000000e+02+9.280000000e+02\n"
        "        +9.290000000e+02+9.300000000e+02+9.310000000e+02+9.320000000e+02\n"
        "        +9.330000000e+02+9.340000000e+02+9.350000000e+02+9.360000000e+02\n"
        "        +9.370000000e+02+9.380000000e+02+9.390000000e+02+9.400000000e+02\n"
        "        +9.410000000e+02+9.420000000e+02+9.430000000e+02+9.440000000e+02\n"
        "        +9.450000000e+02+9.460000000e+02+9.470000000e+02+9.480000000e+02\n"
        "        +9.490000000e+02+9.500000000e+02+9.510000000e+02+9.520000000e+02\n"
        "        +9.530000000e+02+9.540000000e+02+9.550000000e+02+9.560000000e+02\n"
        "        +9.570000000e+02+9.580000000e+02+9.590000000e+02+9.600000000e+02\n"
        "        +9.610000000e+02+9.620000000e+02+9.630000000e+02+9.640000000e+02\n"
        "        +9.650000000e+02+9.660000000e+02+9.670000000e+02+9.680000000e+02\n"
        "        +9.690000000e+02+9.700000000e+02+9.710000000e+02+9.720000000e+02\n"
        "        +9.730000000e+02+9.740000000e+02+9.750000000e+02+9.760000000e+02\n"
        "        +9.770000000e+02+9.780000000e+02+9.790000000e+02+9.800000000e+02\n"
        "        +9.810000000e+02+9.820000000e+02+9.830000000e+02+9.840000000e+02\n"
        "        +9.850000000e+02+9.860000000e+02+9.870000000e+02+9.880000000e+02\n"
        "        +9.890000000e+02+9.900000000e+02+9.910000000e+02+9.920000000e+02\n"
        "        +9.930000000e+02+9.940000000e+02+9.950000000e+02+9.960000000e+02\n"
        "        +9.970000000e+02+9.980000000e+02+9.990000000e+02+1.000000000e+03\n"
        "        +1.001000000e+03+1.002000000e+03+1.003000000e+03+1.004000000e+03\n"
        "        +1.005000000e+03+1.006000000e+03+1.007000000e+03+1.008000000e+03\n"
        "        +1.009000000e+03+1.010000000e+03+1.011000000e+03+1.012000000e+03\n"
        "        +1.013000000e+03+1.014000000e+03+1.015000000e+03+1.016000000e+03\n"
        "        +1.017000000e+03+1.018000000e+03+1.019000000e+03+1.020000000e+03\n"
        "        +1.021000000e+03+1.022000000e+03+1.023000000e+03+1.024000000e+03\n"
        "        +1.025000000e+03+1.026000000e+03+1.027000000e+03+1.028000000e+03\n");
    SECTION("huge") {
        std::vector<long> ref_irmemb(1019);
        for (int i = 0; i < 1019; i++)
            ref_irmemb[i] = i + 10;

        gsetmemb probe(2, 3, gsetmemb::types::NODE_SET, gsetmemb::origins::LINE_OR_CURVE_ORIGIN, ref_irmemb);
        test << probe;
        CHECK(test.str() == ref_1 + ref_2 + ref_3);
    }
    SECTION("huge (2)") {
        std::vector<long> ref_irmemb(1029);
        for (int i = 0; i < 1029; i++)
            ref_irmemb[i] = i + 10;

        gsetmemb probe(2, 3, gsetmemb::types::NODE_SET, gsetmemb::origins::LINE_OR_CURVE_ORIGIN, ref_irmemb);
        test << probe;
        CHECK(test.str() == ref_1 + ref_2 + ref_3 +
              "GSETMEMB+1.500000000e+01+2.000000000e+00+4.000000000e+00+1.000000000e+00\n"
              "        +2.000000000e+00+1.029000000e+03+1.030000000e+03+1.031000000e+03\n"
              "        +1.032000000e+03+1.033000000e+03+1.034000000e+03+1.035000000e+03\n"
              "        +1.036000000e+03+1.037000000e+03+1.038000000e+03\n");
    }
}

TEST_CASE("FEM GSETMEMB conversion from own output.", "[fem_gsetmemb,in/out]") {

    vector<std::string> lines;

    SECTION("GSETMEMB (1)") {
        vector<std::string> data({
            "GSETMEMB+5.000000000e+00+2.000000000e+00+3.000000000e+00+2.000000000e+00\n",
            "        +3.000000000e+00\n"});

        size_t len = __base::card::card_split(data, data.size(), lines);
        gsetmemb probe(lines, len);

        CHECK(probe.NFIELD == 5);
        CHECK(probe.ISREF == 2);
        CHECK(probe.INDEX == 3);
        CHECK(probe.ISTYPE == gsetmemb::types::ELEM_SET);
        CHECK(probe.ISORIG == gsetmemb::origins::SURFACE_ORIGIN);
        CHECK(probe.IRMEMB == std::vector<long>({}));
    }
}

// Local Variables:
// mode: c++
// coding: utf-8
// c-file-style: "dnvgl"
// indent-tabs-mode: nil
// compile-command: "make -C ../cbuild -j8&&
//    (make -C ../cbuild test;
//     ../cbuild/tests/test_fem_cards --use-colour no)"
// End:
